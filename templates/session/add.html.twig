{% extends 'base.html.twig' %}

{% block title %}Calendrier des sorties{% endblock %}

{% block body %}
    <div class="wrapper wrapper-medium-width full-background">
        <div class="wrapper-title">
            <h1>Inscription</h1>
        </div>
        <div class="wrapper-body">
            <div class="block background-ligth">
            {{ form_start(form) }}
                {% set bikeRide = event %}
                <div class="block-title bike-ride-date active">
                    <h2>
                        {% if bikeRide.endAt is null %}
                            {{ bikeRide.startAt | format_date(locale='fr', pattern='EEEE d/M/Y') | capitalize}}
                        {% else %}
                            du {{ bikeRide.startAt | format_date(locale='fr', pattern='EEEE d/M/Y') | capitalize}}}} au {{ event.endAt | format_date(locale='fr', pattern='EEEE d/M/Y') | capitalize}}}} 
                        {% endif %}
                    </h2>
                </div>
                <div class="block-body">
                    <h3>{{ bikeRide.title }}</h3>
                    {% if bikeRide.minAge is not null %}
                        <p class='info'>A partir de {{ bikeRide.minAge }} ans</p>
                    {% endif %}
                    <p>{{ bikeRide.content |raw }}</p>
                    <div class="form-group">
                        {% if form.cluster is defined %}
                            {% set field = form.cluster %}
                        {% endif %}
                        {% if form.availability is defined %}
                            {% set field = form.availability %}
                        {% endif %}
                        {% if field is defined %}
                            {% for  child in field.children %}
                                <div class="inputGroup {{ child.vars.value == field.vars.value ? 'check' : 'ballot' }}">
                                    {{ form_widget(child)}}
                                    {{ form_label(child)}}
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                    {% if form.availability is defined %}
                        <div class="row">
                            <div class="col-md-6 col-xs-12">
                                {% if framers is not empty %}
                                    <h2>Encrants déjà inscrits</h2>
                                    <ul>
                                        {% for framer in framers %}
                                            <li> 
                                                <div class="row row-list">
                                                    <div class="col-md-8 col-xs-6">{{ framer.user.member.fullName }}</div>
                                                    <div class="col-md-4 col-xs-6">{{ framer.availability | trans }}</div>
                                                </div>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                {% else %}
                                    <p>Aucun encrant inscrit</p>
                                {% endif %}
                            </div>
                            <div class="col-md-6 col-xs-12">
                            {% if members is not empty %}
                                    <h2>Participants</h2>
                                    <ul>
                                        {% for membersPerLevel in members %}
                                            <li> 
                                                <div class="row row-list">
                                                    <div class="col-md-6 col-xs-6">{{ membersPerLevel.title }}</div>
                                                    <div class="col-md-6 col-xs-6">{{ membersPerLevel.members | length }}</div>
                                                </div>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    {{ form_errors(form)}}
                    {{ form_row(form.user)}}
                </div>
                <div class="block-footer">
                    {% if form.submit is defined %}
                        {{ form_row(form.submit)}}
                    {% else %}
                        <a href="{{ path('user_account') }}" class="btn btn-primary float-right">Voir toutes mes sorties</a>
                    {% endif %}
                </div>
            {{ form_end(form) }}
    
            </div>
        </div>
    </div>
{% endblock %}
