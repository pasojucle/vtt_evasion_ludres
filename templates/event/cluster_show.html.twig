{% extends 'base.html.twig' %}
{% block title %}{{ event.title }}{% endblock %}

{% block body %}
 <div class="wrapper">
    <div class="block">
        <div class="block-title">
            <h2>{{ event.title }} - 
                {% if event.endAt is null %}
                    {{ event.startAt | format_date(locale='fr', pattern='EEEE d/M/yy') | capitalize}}
                {% else %}
                    du {{ event.startAt | format_date(locale='fr', pattern='EEEE d/M/yy') | capitalize}} au {{ event.endAt | format_date(locale='fr', pattern='EEEE d/M/Y') | capitalize}}
                {% endif %}
            </h2>
            <span class="tools">
                <a href="{{ path('admin_events', events_filters) }}" class="btn btn-secondary btn-ico" title="Retour Ã  la liste des sorties"><i class="fas fa-chevron-left"></i></a>
            </span>
        </div>
        <div  id="sessions_container" class="block-body">
            {% for cluster in event.clusters %}
                {% set presentCount = cluster.presentCount %}
                {% set cluster = cluster.cluster %}
                {% set hasGroups = event.clusters| length > 1 %}
                {% if hasGroups %}
                    <h3>{{ cluster.title }} - <span class="badge badge-info">{{ presentCount }}</span></h3>
                {% endif %} 
                {% if cluster.sessions | length > 0 %}
                    <ul>
                        {% for session in cluster.sessionAvailable %}             
                            {% include ('event/session.html.twig')%}
                        {% endfor %}
                    </ul>
                    {% if hasGroups and not cluster.isComplete and cluster.title != constant('App\\Entity\\Cluster::CLUSTER_FRAME') %}
                        <a href="{{ path('admin_cluster_export', {'cluster': cluster.id}) }}" class="btn btn-100 btn-success cluster-complete" data-cluster-id="{{ cluster.id }}" target="_blank">
                            <i class="fas fa-check"></i> Valider le groupe
                        </a>
                    {% endif %}
                {% else %}
                    <p>Auncun inscrit</p>
                {% endif %}
                <br>
            {% endfor %}
        </div>
    </div>
    <a class="btn btn-primary" href="{{ path('admin_session_add', {'event': event.id}) }}">Ajouter un participant</a>
{% endblock %}
